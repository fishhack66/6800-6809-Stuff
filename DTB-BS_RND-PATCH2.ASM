* PATCH FOR DENDAI TINY BASIC - DAVE HASSLER
* FOR HM-68 COMPUTER, MAR. 2024.
*
* 1) PLACE A FUNCTIONING RANDOM NUMBER ROUTINE
*    AT $0004. (GENERATES NUMBERS $0000-$FFFF)
* 2) USE 'BACKSPACE' KEY (ASCII 08) INSTEAD OF CTRL-O
* 3) LOCATION $01C5 IS 'END OF USER RAM' LOCATION,
*    CURRENTLY SET TO $1EFF (ABT 5.5 KB).
*    CHANGE TO SUIT.


RND	EQU	$20

	ORG	$0004

RANDOM	LDAA	RND+1
	LDAB	RND
	ADDB	RND+1
	ADCA	#$95
	ADCB	#$AB
	STAB	RND
	STAA	RND+1
	EORA	RND
	ANDA	#$7F
	STAA	RND
	RTS

	ORG	$012F

GL3	EORA	$20

	ORG	$0150

GL5	CMPA	#$08
	BNE	GL6
	LDAA	#$20
	JSR	BACKSPC
	CPX	#$0030
	BEQ	GL3
	DEX
	BRA	GL3

GL6	CPX	#$0076

	ORG	$01B8

BACKSPC	JSR	$0448	SPACE OUT
	LDAA	#$08
	JSR	$0448	BACKSPACE OUT
	RTS
